 <div class="min-h-screen bg-[#0B0E14] text-slate-300 font-sans selection:bg-indigo-500 selection:text-white pb-20">

       <div *ngIf="loading" class="fixed inset-0 z-50 flex items-center justify-center bg-[#0B0E14]">
         <div class="flex flex-col items-center gap-4">
           <div class="w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"></div>
           <p class="text-indigo-400 font-medium tracking-wide animate-pulse">Cargando...</p>
         </div>
       </div>

       <div *ngIf="error && !loading" class="max-w-md mx-auto mt-10 p-4 bg-red-900/20 border border-red-500/30 rounded-lg text-center">
         <p class="text-red-400">{{ error }}</p>
       </div>

       <div *ngIf="professionalData && !loading" class="animate-fadeIn">

         <!-- Header -->
         <div class="relative pt-12 pb-8 bg-gradient-to-b from-[#111827] to-[#0B0E14]">
           <div class="container mx-auto px-4">
             <button (click)="cancelEditing()"
                     class="mb-6 flex items-center gap-2 text-slate-400 hover:text-white transition-colors">
               <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                 <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
               </svg>
               Volver al perfil
             </button>

             <h1 class="text-3xl md:text-4xl font-bold text-white mb-2">Editar Perfil Profesional</h1>
             <p class="text-slate-400">Actualiza tu información personal y profesional</p>
           </div>
         </div>

         <!-- Form Container -->
         <div class="container mx-auto px-4 mt-8 max-w-4xl">
           <form [formGroup]="profileForm" (ngSubmit)="onSubmitProfile()" class="space-y-6">

             <!-- Photo & Avatar Section -->
             <div class="bg-[#161b26] border border-slate-800 rounded-2xl p-6">
               <h3 class="text-lg font-bold text-white mb-6 flex items-center gap-2">
                 <span class="w-1 h-6 bg-indigo-500 rounded-full"></span>
                 Fotos de Perfil
               </h3>

               <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                 <!-- Personal Photo -->
                 <div class="text-center">
                   <label class="block text-sm font-medium text-slate-300 mb-3">Foto Personal</label>
                   <div class="relative inline-block">
                     <div class="w-32 h-32 rounded-full p-1 bg-gradient-to-tr from-indigo-500 via-purple-500 to-pink-500">
                       <div class="w-full h-full rounded-full overflow-hidden bg-[#1f2937] border-4 border-[#0B0E14]">
                         <img *ngIf="professionalData.user.photoUrl && !imageLoadFailed"
                              [src]="getPhotoUrl()" (error)="handleImageError()"
                              alt="Profile"
                              class="w-full h-full object-cover" />
                         <div *ngIf="!professionalData.user.photoUrl || imageLoadFailed"
                              class="w-full h-full flex items-center justify-center bg-[#1f2937] text-white text-3xl font-bold">
                           {{ getInitials() }}
                         </div>
                       </div>
                     </div>
                     <button type="button" (click)="photoInput.click()"
                             class="absolute bottom-0 right-0 bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-full shadow-lg transition-colors">
                       <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                         <path fill-rule="evenodd" d="M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1
    0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" />
                       </svg>
                     </button>
                     <input #photoInput type="file" (change)="onPhotoSelect($event)" class="hidden" accept="image/*">
                   </div>
                   <p class="text-xs text-slate-500 mt-3">Máximo 7MB</p>
                   <div *ngIf="uploadingPhoto" class="mt-2 flex items-center justify-center gap-2 text-indigo-400">
                     <div class="w-4 h-4 border-2 border-indigo-400 border-t-transparent rounded-full animate-spin"></div>
                     <span class="text-sm">Subiendo...</span>
                   </div>
                 </div>

                 <!-- Business Logo -->
                 <div class="text-center">
                   <label class="block text-sm font-medium text-slate-300 mb-3">Logo de Negocio</label>
                   <div class="relative inline-block">
                     <div class="w-32 h-32 rounded-xl bg-[#1f2937] border-4 border-slate-700 overflow-hidden">
                       <img *ngIf="professionalData.professional.avatarUrl"
                            [src]="getAvatarUrl()"
                            alt="Business Logo"
                            class="w-full h-full object-cover" />
                       <div *ngIf="!professionalData.professional.avatarUrl"
                            class="w-full h-full flex items-center justify-center text-slate-500">
                         <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                           <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0
   011-1h2a1 1 0 011 1v5m-4 0h4" />
                         </svg>
                       </div>
                     </div>
                     <button type="button" (click)="avatarInput.click()"
                             class="absolute bottom-0 right-0 bg-purple-600 hover:bg-purple-500 text-white p-2 rounded-full shadow-lg transition-colors">
                       <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                         <path fill-rule="evenodd" d="M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1
    0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" />
                       </svg>
                     </button>
                     <input #avatarInput type="file" (change)="onAvatarSelect($event)" class="hidden" accept="image/*">
                   </div>
                   <p class="text-xs text-slate-500 mt-3">Máximo 7MB</p>
                   <div *ngIf="uploadingAvatar" class="mt-2 flex items-center justify-center gap-2 text-purple-400">
                     <div class="w-4 h-4 border-2 border-purple-400 border-t-transparent rounded-full animate-spin"></div>
                     <span class="text-sm">Subiendo...</span>
                   </div>
                 </div>
               </div>
             </div>

             <!-- Personal Information -->
             <div class="bg-[#161b26] border border-slate-800 rounded-2xl p-6">
               <h3 class="text-lg font-bold text-white mb-6 flex items-center gap-2">
                 <span class="w-1 h-6 bg-emerald-500 rounded-full"></span>
                 Información Personal
               </h3>

               <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                 <div>
                   <label class="block text-sm font-medium text-slate-300 mb-2">Nombre *</label>
                   <input type="text" formControlName="name"
                          class="w-full px-4 py-3 bg-[#0B0E14] border rounded-lg text-white focus:outline-none focus:ring-2 transition-all"
                          [ngClass]="isInvalid('name') ? 'border-red-500 focus:ring-red-500' : 'border-slate-700 focus:ring-indigo-500'">
                   <p *ngIf="isInvalid('name')" class="text-red-400 text-xs mt-1">El nombre es requerido</p>
                 </div>

                 <div>
                   <label class="block text-sm font-medium text-slate-300 mb-2">Apellido *</label>
                   <input type="text" formControlName="lastName"
                          class="w-full px-4 py-3 bg-[#0B0E14] border rounded-lg text-white focus:outline-none focus:ring-2 transition-all"
                          [ngClass]="isInvalid('lastName') ? 'border-red-500 focus:ring-red-500' : 'border-slate-700 focus:ring-indigo-500'">
                   <p *ngIf="isInvalid('lastName')" class="text-red-400 text-xs mt-1">El apellido es requerido</p>
                 </div>

                 <div>
                   <label class="block text-sm font-medium text-slate-300 mb-2">Teléfono *</label>
                   <input type="tel" formControlName="phone"
                          class="w-full px-4 py-3 bg-[#0B0E14] border rounded-lg text-white focus:outline-none focus:ring-2 transition-all"
                          [ngClass]="isInvalid('phone') ? 'border-red-500 focus:ring-red-500' : 'border-slate-700 focus:ring-indigo-500'">
                   <p *ngIf="isInvalid('phone')" class="text-red-400 text-xs mt-1">El teléfono es requerido</p>
                 </div>

                 <div>
                   <label class="block text-sm font-medium text-slate-300 mb-2">WhatsApp</label>
                   <input type="tel" formControlName="whatsappNumber"
                          class="w-full px-4 py-3 bg-[#0B0E14] border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all">
                 </div>

                 <div>
                   <label class="block text-sm font-medium text-slate-300 mb-2">Email de Negocio</label>
                   <input type="email" formControlName="businessEmail"
                          class="w-full px-4 py-3 bg-[#0B0E14] border rounded-lg text-white focus:outline-none focus:ring-2 transition-all"
                          [ngClass]="isInvalid('businessEmail') ? 'border-red-500 focus:ring-red-500' : 'border-slate-700 focus:ring-indigo-500'">
                   <p *ngIf="isInvalid('businessEmail')" class="text-red-400 text-xs mt-1">Email inválido</p>
                 </div>

                 <div>
                   <label class="block text-sm font-medium text-slate-300 mb-2">Años de Experiencia</label>
                   <input type="number" formControlName="totalExperience" min="0" max="100"
                          class="w-full px-4 py-3 bg-[#0B0E14] border rounded-lg text-white focus:outline-none focus:ring-2 transition-all"
                          [ngClass]="isInvalid('totalExperience') ? 'border-red-500 focus:ring-red-500' : 'border-slate-700 focus:ring-indigo-500'">
                   <p *ngIf="isInvalid('totalExperience')" class="text-red-400 text-xs mt-1">Debe ser entre 0 y 100</p>
                 </div>
               </div>

               <div class="mt-4">
                 <label class="block text-sm font-medium text-slate-300 mb-2">Biografía</label>
                 <textarea formControlName="bio" rows="4"
                           class="w-full px-4 py-3 bg-[#0B0E14] border rounded-lg text-white focus:outline-none focus:ring-2 transition-all resize-none"
                           [ngClass]="isInvalid('bio') ? 'border-red-500 focus:ring-red-500' : 'border-slate-700 focus:ring-indigo-500'"
                           placeholder="Cuéntanos sobre ti y tu experiencia profesional..."></textarea>
                 <p class="text-xs text-slate-500 mt-1">Máximo 500 caracteres</p>
                 <p *ngIf="isInvalid('bio')" class="text-red-400 text-xs mt-1">La biografía no debe superar 500 caracteres</p>
               </div>
             </div>

             <!-- Online Presence -->
             <div class="bg-[#161b26] border border-slate-800 rounded-2xl p-6">
               <h3 class="text-lg font-bold text-white mb-6 flex items-center gap-2">
                 <span class="w-1 h-6 bg-blue-500 rounded-full"></span>
                 Presencia Online
               </h3>

               <div class="space-y-4">
                 <div>
                   <label class="block text-sm font-medium text-slate-300 mb-2">Sitio Web</label>
                   <input type="url" formControlName="websiteUrl"
                          class="w-full px-4 py-3 bg-[#0B0E14] border rounded-lg text-white focus:outline-none focus:ring-2 transition-all"
                          [ngClass]="isInvalid('websiteUrl') ? 'border-red-500 focus:ring-red-500' : 'border-slate-700 focus:ring-indigo-500'"
                          placeholder="https://misitio.com">
                   <p *ngIf="isInvalid('websiteUrl')" class="text-red-400 text-xs mt-1">URL inválida (debe comenzar con http:// o https://)</p>
                 </div>

                 <div>
                   <label class="block text-sm font-medium text-slate-300 mb-2">LinkedIn</label>
                   <input type="url" formControlName="linkedinProfile"
                          class="w-full px-4 py-3 bg-[#0B0E14] border rounded-lg text-white focus:outline-none focus:ring-2 transition-all"
                          [ngClass]="isInvalid('linkedinProfile') ? 'border-red-500 focus:ring-red-500' : 'border-slate-700 focus:ring-indigo-500'"
                          placeholder="https://linkedin.com/in/usuario">
                   <p *ngIf="isInvalid('linkedinProfile')" class="text-red-400 text-xs mt-1">URL inválida</p>
                 </div>

                 <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                   <div>
                     <label class="block text-sm font-medium text-slate-300 mb-2">Facebook</label>
                     <input type="text" formControlName="facebookProfile"
                            class="w-full px-4 py-3 bg-[#0B0E14] border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all"
                            placeholder="usuario">
                   </div>

                   <div>
                     <label class="block text-sm font-medium text-slate-300 mb-2">Instagram</label>
                     <input type="text" formControlName="instagramProfile"
                            class="w-full px-4 py-3 bg-[#0B0E14] border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all"
                            placeholder="@usuario">
                   </div>
                 </div>

                 <div>
                   <label class="block text-sm font-medium text-slate-300 mb-2">YouTube</label>
                   <input type="url" formControlName="youtubeChannel"
                          class="w-full px-4 py-3 bg-[#0B0E14] border rounded-lg text-white focus:outline-none focus:ring-2 transition-all"
                          [ngClass]="isInvalid('youtubeChannel') ? 'border-red-500 focus:ring-red-500' : 'border-slate-700 focus:ring-indigo-500'"
                          placeholder="https://youtube.com/@canal">
                   <p *ngIf="isInvalid('youtubeChannel')" class="text-red-400 text-xs mt-1">URL inválida</p>
                 </div>
               </div>
             </div>

             <!-- Visibility Settings -->
             <div class="bg-[#161b26] border border-slate-800 rounded-2xl p-6">
               <h3 class="text-lg font-bold text-white mb-6 flex items-center gap-2">
                 <span class="w-1 h-6 bg-purple-500 rounded-full"></span>
                 Configuración de Visibilidad
               </h3>

               <label class="flex items-center gap-3 cursor-pointer group">
                 <input type="checkbox" formControlName="visible"
                        class="w-5 h-5 rounded border-slate-700 bg-[#0B0E14] text-indigo-600 focus:ring-2 focus:ring-indigo-500 focus:ring-offset-0 cursor-pointer">
                 <div>
                   <span class="text-white font-medium group-hover:text-indigo-400 transition-colors">Perfil visible en búsquedas</span>
                   <p class="text-sm text-slate-400">Los usuarios podrán encontrarte y contactarte</p>
                 </div>
               </label>
             </div>

             <!-- Action Buttons -->
             <div class="flex flex-col sm:flex-row justify-end gap-4 sticky bottom-4 bg-[#0B0E14]/95 backdrop-blur-sm p-4 rounded-xl border border-slate-800">
               <button type="button" (click)="cancelEditing()"
                       class="px-8 py-3 rounded-lg text-slate-400 hover:text-white hover:bg-slate-800 border border-slate-700 transition-all font-medium">
                 Cancelar
               </button>
               <button type="submit" [disabled]="saving || profileForm.invalid"
                       class="px-8 py-3 rounded-lg bg-[#F59E0B] hover:bg-[#d97706] disabled:bg-slate-700 disabled:text-slate-500 text-black font-bold shadow-lg transition-all flex items-center justify-center
   gap-2">
                 <span *ngIf="saving" class="w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"></span>
                 <span>{{ saving ? 'Guardando...' : 'Guardar Cambios' }}</span>
               </button>
             </div>

           </form>
         </div>

       </div>
     </div>
